<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Danh Sách Đơn Hàng</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" th:href="@{/css/global.css}" type="text/css"/>
    <style>
        /* Add any custom styling for the order list page */
        .order-table th, .order-table td {
            vertical-align: middle;
        }


        .order-status {
            font-weight: bold;
        }

        .order-total {
            color: #d9534f;
            font-weight: bold;
        }

        .product-image {
            width: 100px;
            height: 100px;
            object-fit: cover;
        }
    </style>
</head>
<body>
<!-- Navbar -->
<div th:replace="fragments/navbar :: navbar"></div>
<div class="main-content">
    <div class="container my-5">
        <h1 class="mb-4">Danh Sách Đơn Hàng</h1>

        <table class="table order-table mt-4">
            <thead class="table-light">
            <tr>
                <th>Mã đơn</th>
                <th>Ngày đặt</th>
                <th>Trạng thái</th>
                <th>Tổng tiền</th>
                <th>Hình ảnh sản phẩm</th> <!-- Added image column -->
                <th>Chi tiết</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="order : ${orders}">
                <td th:text="${order.id}">1</td>
                <td th:text="${#temporals.format(order.orderDate, 'dd/MM/yyyy HH:mm')}">01/01/2025</td>
                <td class="order-status" th:text="${order.status}">Đang xử lý</td>
                <td class="order-total" th:text="${#numbers.formatDecimal(order.totalAmount, 0, 'COMMA', 0, 'POINT')} + '₫'">0₫</td>
                <td th:each="item : ${order.orderItems}">
                    <!-- Kiểm tra xem product có phải là null không -->
                    <img th:if="${item.product != null and not item.product.images.isEmpty()}"
                         th:src="@{${item.product.images[0].imageUrl}}"
                         class="product-image"
                         alt="Product Image" />
                    <img th:if="${item.product == null or item.product.images.isEmpty()}"
                         th:src="@{/images/placeholder.jpg}"
                         class="product-image"
                         alt="No Image" />
                </td>

                <td>
                    <a class="btn btn-primary" th:href="@{'/order/detail/' + ${order.id}}">Xem chi tiết</a>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>


<!-- Footer -->
<div th:replace="fragments/footer :: footer"></div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
